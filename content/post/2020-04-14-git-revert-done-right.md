+++
date = "2020-04-14T00:00:00Z"
tags = ["git"]
categorise = ["unix"]
title = "正确使用 git revert"

+++

最近同事不小心把没测试过特性分支 F 的代码合并到主分支 M 上了，就从 M 上切了个热
补丁分支 H，做了个 revert 操作合并到 M 上去了。之后要布署 F 到开发分支 D 上时，
先合并  M 到 D 做了下同步，然后就发现 F 死活合不到 D 上。明明两边的代码不一样，但是
就是合不上，不只合不上，github 上显示没有什么需要合的。

一图胜千言，我们画下图就知道，D 此时是 F 的后继节点，所以 D 认为 F 早已合并了，
所以当然没有什么需要合并的。

```
.----.
| M1 |\
'----' \
   |    \ .----.
   |      | F  |
   |     /'----'
   |    /
.----. /
| M2 | \
'----'  \
   |     \ .----.
   |      /| H  |
   |     / '----'
   |    /
.----. /
| M3 |\
'----' \
        \
         \
          .----.
          | D  |
          '----'
```

此时正确的做法应该是 F 分支将 M3 merge 过来，然后再将 revert 内容 revert 掉。
